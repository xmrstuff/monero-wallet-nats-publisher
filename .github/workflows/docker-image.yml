name: Docker Image CI

on:
  push:
    branches: [ develop ]

jobs:

  dockerhub_push:
    runs-on: ubuntu-latest

    env:
      IMAGE_TAG: xmrstuff/monero-wallet-nats-publisher:v0.0.1

    steps:
    - uses: actions/checkout@v2
    - name: Build the Docker image
      run: docker build --tag ${{ env.IMAGE_TAG }} .
    # - name: Login to GitHub Packages Docker Registry
    #   uses: docker/login-action@v1
    #   with:
    #     registry: index.docker.io/v1/
    #     username: ${{ github.repository_owner }}
    #     password: ${{ secrets.GITHUB_TOKEN }}
    - name: Login to DockerHub
      run: docker login -u ${{ secrets.DOCKERHUB_USERNAME }} -p ${{ secrets.DOCKERHUB_TOKEN }}
    - name: Push to DockerHub
      run: docker push ${{ env.IMAGE_TAG }}